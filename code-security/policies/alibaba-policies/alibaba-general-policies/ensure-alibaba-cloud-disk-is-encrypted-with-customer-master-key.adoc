== Alibaba Cloud Disk is not encrypted with Customer Master Key (CMK)


*Policy Details* 

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| db67af3f-47dd-49ca-9a96-ce12924d9d89

|Checkov Check ID 
| https://github.com/bridgecrewio/checkov/tree/master/checkov/terraform/checks/resource/alicloud/DiskEncryptedWithCMK.py[CKV_ALI_8]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Terraform

|=== 



*Description* 


Alibaba Cloud disks (disk) not encrypted with a customer master key renders the data stored on the disk vulnerable to unauthorized access and potential data breaches. If the disk is accessed by an unauthorized party, the sensitive data on it can be easily compromised, leading to loss of confidentiality and integrity of the data. To prevent this risk, encrypt Alibaba Cloud disks with CMKs to ensure that only authorized users with the correct key can access and decrypt the data.

=== Fix - Buildtime


*Terraform*

To encrypt your disk, add the following code to your Terraform file during buildtime.



[source,go]
----
{
  "codes": [
    {
      "code": "resource "alicloud_disk" "pass" {
  # cn-beijing
  description = "Hello ecs disk."
  category    = "cloud_efficiency"
  size        = "30"
  encrypted   = true
  kms_key_id  = "2a6767f0-a16c-1234-5678-13bf*****"
  tags = {
    Name = "TerraformTest"
  }
}",
      "language": "go"
    }
  ]
}
----
