== AWS RedShift Cluster is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)


*Description* 


This policy identifies RedShift Clusters which are encrypted with default KMS keys and not with Keys managed by Customer.
It is a best practice to use customer managed KMS Keys to encrypt your RedShift Cluster data.
It gives you full control over the encrypted data.

=== Fix - Buildtime


*Terraform* 


* *Resources: aws_efs_file_system
* *Arguments: encrypted


[source,go]
----
{
  "codes": [
    {
      "code": "resource "aws_redshift_cluster" "pass" {
  cluster_identifier                  = "examplea"
  availability_zone                   = data.aws_availability_zones.available.names[0]
  database_name                       = "mydb"
  master_username                     = "foo_test"
  master_password                     = "Mustbe8characters"
  node_type                           = "dc2.large"
  automated_snapshot_retention_period = 0
  allow_version_upgrade               = false
  skip_final_snapshot                 = true
  encrypted                           = true
  kms_key_id                          = aws_kms_key.test.arn
}
",
      "language": "go"
    }
  ]
}
----
